<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="..\..\bower_components/polymer/polymer.html">
<link rel="import" href="..\..\bower_components/iron-icons/iron-icons.html">
<link rel="import" href="..\..\bower_components/iron-icons/editor-icons.html">
<link rel="import" href="..\..\bower_components/iron-icons/image-icons.html">
<link rel="import" href="..\..\bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="..\..\bower_components/paper-input/paper-input.html">

<dom-module id="drum-excercise">
    <template>
        <style>
            :host {
                display: block;
            }
            
            paper-material {
                border-radius: 2px;
                height: 100%;
                padding: 16px 0 16px 0;
                margin: 16px auto;
                background: white;
                width: calc(98% - 46px);
                margin-bottom: 32px;
                padding-left: 30px;
                padding-right: 30px;
                cursor: pointer;
            }
            
            .row {
                display: flex;
                flex-direction: row;
                align-items: center;
            }
        </style>
        <paper-material on-tap="completeTask">
            <paper-ripple></paper-ripple>
            <div class="row">
                <div on-tap="editExcerciseName" hidden$="{{isNameEdit}}">{{excercise.name}}</div>
                <paper-input on-tap="editting" type="text" hidden$="{{!isNameEdit}}" value={{excercise.name}}></paper-input>
            </div>
            <div class="row">
                <div>BPM:</div>
                <div on-tap="editBpm" hidden$="{{isBpmEdit}}">{{excercise.bpm}}</div>
                <paper-input on-tap="editting" type="number" hidden$="{{!isBpmEdit}}" value={{excercise.bpm}}></paper-input>
                <paper-icon-button icon="image:timer"></paper-icon-button>
            </div>
        </paper-material>
    </template>
    <script>
        (function() {
    'use strict';

    Polymer({
      is: 'drum-excercise',

      properties: {
        excercise: Object,
        isNameEdit : {
            type: Boolean,
            value: false
        },
        isBpmEdit : {
            type: Boolean,
            value: false
        }
      },
      
      completeTask : function(){
          this.set("excercise.bpm", ++this.excercise.bpm);
          this.fire("excerciseCompleted", {id: this.excercise.id});
      },
      
      editting : function(e){
          e.stopPropagation();

      },
      
      editExcerciseName : function(e){
          e.stopPropagation();
          this.isNameEdit = true;
          
          //save the change and switch to view mode
          setTimeout(() => {
              this.isNameEdit = false;
              this.fire("excerciseUpdated", {id: this.excercise.id});
          }, 15000);
      },
      
      editBpm : function(e){
          e.stopPropagation();
          this.isBpmEdit = true;
          //save the change and switch to view mode
          setTimeout(() => {
              this.isBpmEdit = false;
              this.fire("excerciseUpdated", {id: this.excercise.id});
          }, 15000);
      }
    });
  })();
    </script>
</dom-module>